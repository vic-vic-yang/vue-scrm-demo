webpackJsonp([56],{"+9n3":function(t,e,a){var n=a("iC9F");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("2423b90e",n,!0)},"8j1o":function(t,e,a){"use strict";var n=a("//Fk"),o=a.n(n),s=a("zL8q"),i=(a.n(s),a("gyMJ"));e.a={list:function(t){return i.a.get("/integral/v1/goods/goods",{params:t}).then(function(t){return t.data})},del:function(t){return i.a.delete("/integral/v1/goods/goods/"+t,{autoShowMessage:!0})},status:function(t){return i.a.put("/integral/v1/goods/goods/"+t.id+"/status/"+t.status,{autoShowMessage:!0,showMessageType:"put"})},get:function(t){return i.a.get("/integral/v1/goods/goods/"+t).then(function(t){return t.data})},add:function(t){return i.a.post("/integral/v1/goods/goods",t,{autoShowMessage:!0})},edit:function(t){return i.a.put("/integral/v1/goods/goods/"+t.id,t,{autoShowMessage:!0,showMessageType:"put"})},upload:function(t,e){if(!e)return Object(s.Message)({message:"上传文件不能为空",type:"error",duration:3e3}),o.a.reject(!1);var a=new FormData;return a.append("goods_id",t),a.append("file",e),i.a.post("/integral/v1/goods/goods/import-card-number",a,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4}).then(function(t){return 200===t.code?t.data:o.a.reject(t)})}}},iC9F:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},xu3b:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),s=a("YK4W"),i=a("8j1o"),l=a("M4fF"),r=a.n(l),u=a("0xDb"),c={name:"commodity-list",components:{customElTable:s.a},data:function(){return{tableOptions:[{label:"编号",prop:"id",width:80},{label:"商品",prop:"goods",width:400,options:{type:"html"}},{label:"访问量",prop:"goods_view_all_and_user",options:{type:"html"}},{label:"库存",prop:"total_num",width:120},{label:"已兑换",prop:"sell_num"},{label:"商品状态",prop:"status_name"},{label:"创建时间",prop:"create_time",sortable:!0,width:200,className:"ph-6"},{prop:"USER_ACTION",actions:["edit",{type:"status",options:this.getStatusBtnInfo},"del"]}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,commodityQueryFrm:{name:"",type:0,status:0},query:null,commodityTypeOptions:[{label:"全部",value:0},{label:"实物",value:1},{label:"电子卡卷",value:2}],statusOptions:[{label:"全部商品",value:0},{label:"已上架",value:1},{label:"已下架",value:2},{label:"仓库中",value:3}]}},created:function(){this.getData()},methods:{getData:function(){var t=this,e=this.query||{};this.tabLoading=!0,i.a.list(o()({page_index:this.pageIndex,page_size:this.pageSize},e)).then(function(e){t.tableData=(e.result||[]).map(function(t){var e=t.pic&&t.pic.length?t.pic[0]:null;return o()({},t,{goods:'<div class="goods-info" style="display: flex;justify-content: flex-start;align-items: center;margin: 0 15px;">\n                      <div class="img">'+(e?'<img width="144" height="120" src="'+e.file_path+'" />':"")+'</div>\n                      <div class="content" style="margin-left: 30px;display: flex;flex-direction: column;justify-content: space-between;">\n                        <p class="name" style="text-align: left">'+t.name+'</p>\n                        <p class="text" style="display: flex;justify-content: space-between;align-items: center;">\n                          <span>￥'+t.price+'</span>\n                          <span style="display: inline-block;margin-left: 50px;">'+t.integral+"积分</span>\n                        </p>\n                      </div>\n                    <div>",total_num:1*t.total_num-1*t.sell_num,status_name:1*t.status==1?"已上架":"已下架",create_time:""===t.create_time||1*t.create_time==0?"--":Object(u.c)(t.create_time),goods_view_all_and_user:"访客数："+t.goods_view_user+"<br>浏览量："+t.goods_view_all})}),t.totalCount=1*e.totalCount,t.tabLoading=!1}).catch(function(e){t.$message({type:"info",message:e.message})})},searchCommodityList:function(){this.query=r.a.cloneDeep(this.commodityQueryFrm),this.pageIndex=1,this.getData()},createCommodity:function(){this.$router.push({name:"integralCommodityCreate"})},editHandler:function(t){this.$router.push({name:"integralCommodityModify",params:{id:t.id}})},deleteHandler:function(t){var e=this;this.$confirm("确认删除商品 <b>"+t.name+"</b> 吗？","删除",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.a.del(t.id).then(function(){e.$message({type:"success",message:"已删除商品"+t.name}),e.getData()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},actionHandler:function(t,e){var a=this;if("status"===t){var n=this.getStatusBtnInfo(e).label;this.$confirm("确认立即"+n+"商品 <b>"+e.name+"</b> 吗？",n,{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.a.status({id:e.id,status:1*e.status==1?"2":"1"}).then(function(){a.getData()})}).catch(function(){a.$message({type:"info",message:"已取消"+n})})}},sizeChangeHandler:function(t){this.pageSize=t,this.pageIndex=1,this.getData()},pageChangeHandler:function(t){this.pageIndex=t,this.getData()},getStatusBtnInfo:function(t){if(!t)return{btn:"danger",label:"下架"};var e=1*t.status;return 3!==e&&(1===e?{btn:"danger",label:"下架"}:{btn:"primary",label:"上架"})},resetForm:function(t){this.$refs[t].resetFields()}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container commodity-list"},[a("div",{staticClass:"control-group"},[a("el-form",{ref:"commodityQueryFrm",attrs:{inline:!0,model:t.commodityQueryFrm}},[a("el-form-item",{attrs:{prop:"name",label:"商品名"}},[a("el-input",{attrs:{placeholder:"商品名"},model:{value:t.commodityQueryFrm.name,callback:function(e){t.$set(t.commodityQueryFrm,"name",e)},expression:"commodityQueryFrm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"status",label:"商品状态"}},[a("el-select",{attrs:{placeholder:"全部商品",clearable:""},model:{value:t.commodityQueryFrm.status,callback:function(e){t.$set(t.commodityQueryFrm,"status",e)},expression:"commodityQueryFrm.status"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchCommodityList}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(e){t.resetForm("commodityQueryFrm")}}},[t._v("重置")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.createCommodity}},[a("i",{staticClass:"fs-13 el-icon-plus mr-5"}),t._v("发布商品\n        ")])],1)],1)],1),t._v(" "),a("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tabLoading,expression:"tabLoading"}],attrs:{tableData:t.tableData,tableOptions:t.tableOptions,total:t.totalCount},on:{edit:t.editHandler,delete:t.deleteHandler,action:t.actionHandler,"size-change":t.sizeChangeHandler,"page-change":t.pageChangeHandler},model:{value:t.pageIndex,callback:function(e){t.pageIndex=e},expression:"pageIndex"}})],1)},staticRenderFns:[]};var m=a("VU/8")(c,d,!1,function(t){a("+9n3")},"data-v-cce32804",null);e.default=m.exports}});