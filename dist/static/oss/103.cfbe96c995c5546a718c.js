webpackJsonp([103],{3120:function(t,i,e){var n=e("a5cn");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("rjj0")("09b1f1fa",n,!0)},"J/Xd":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("//Fk"),a=e.n(n),l=e("woOf"),s=e.n(l),o=e("4ruC"),c={name:"bindPublicNumber",beforeRouteEnter:function(t,i,e){var n=t.query.v,a=t.query.auth_code;n&&a?o.a.authCallback({code:a,v:n}).then(function(){e({name:t.name,replace:!0})}).catch(function(t){console.log(t),e(function(t){s()(t.dialog,{title:"",type:0,dialogVisible:!0,content:"开放平台帐号管理权限” 已授权给其他平台，不能重复授权，请先到微信公众号后台->公众号设置->授权管理，取消原第三平台的授权",cancelText:"关闭",confirmText:"已取消，重新授权"})})}):e()},data:function(){return{pageLoading:!0,dialogVisible:!1,dialogRelieve:!1,dialogJurisdiction:!1,dbRelieve:!1,userGuideUrl:"",authInfo:[],authStatus:0,authUrl:"",ju_list:null,dialog:{title:"",type:0,dialogVisible:!1,content:"",cancelText:"取消",confirmText:"确定"},un_id:0}},watch:{dialogRelieve:function(t){t||(this.dbRelieve=!1)}},created:function(){var t=this;a.a.all([this.getData(),this.getAuthUrl()]).then(function(){t.pageLoading=!1}).catch(function(){t.pageLoading=!1})},mounted:function(){var t=this;setTimeout(function(){t.authInfo.map(function(i){t.setImg(i)})},1e3)},methods:{setImg:function(t){var i=["src"+t.id];window[i]="";var e=document.getElementById("f"+t.id);window[i]='<img id="img" width="120px" height="120px" alt="qrCode" src=\''+t.qrcode_url+"?"+Math.random()+"' />",e.src="javascript:parent."+i},getData:function(){var t=this;return o.a.getThirdAuthInfo({type:2}).then(function(i){return t.authInfo=i,t.authStatus=1*i.status,t.pageLoading=!1,i}).catch(function(i){return t.pageLoading=!1,a.a.reject(i)})},getAuthUrl:function(){var t=this;return o.a.getAuthUrl({type:2}).then(function(i){return t.authUrl=i.authUrl,i}).catch(function(t){return a.a.reject(t)})},checkJurisdiction:function(t){this.ju_list=t,this.dialogJurisdiction=!0},bindHandler:function(){this.authUrl&&window.open(this.authUrl,"_self")},renewbindHandler:function(){s()(this.dialog,{title:"提示",type:1,dialogVisible:!0,content:"只可重新授权当前授权的小程序。如果要授权其他小程序，请先解除授权当前的小程序。",cancelText:"取消",confirmText:"重新授权"})},unbindHandler:function(t){this.un_id=t.id,this.dialogRelieve=!0},unbindHandlerDialog:function(){var t=this;o.a.unbind({id:this.un_id}).then(function(){t.un_id=0,t.dialogRelieve=!1,location.reload()})},cancelDialog:function(t){this.dialog.dialogVisible=!1,2===t&&location.reload()},confirmDialog:function(t){this.dialog.dialogVisible=!1,1*t==1||1*t==0?(this.authUrl&&window.open(this.authUrl,"_blank"),s()(this.dialog,{title:"提示",type:2,dialogVisible:!0,content:"请在新窗口中完成公众号授权",confirmText:"授权成功",cancelText:"授权失败"})):2===t&&location.reload()},introduceHandler:function(){this.userGuideUrl&&window.open(this.userGuideUrl,"_blank")}}},r={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"app-container"},[e("h4",{staticClass:"mv-30"},[t._v("授权微信公众号\n    "),t.userGuideUrl?e("el-button",{staticClass:"mh-10",attrs:{type:"text"},on:{click:t.introduceHandler}},[t._v("教程说明")]):t._e(),t._v(" "),e("el-button",{staticClass:"mh-10",attrs:{type:"text"},on:{click:t.bindHandler}},[e("i",{staticClass:"el-icon-plus mr-5"}),t._v("添加微信公众号")])],1),t._v(" "),t.authInfo&&t.authInfo.length>0?t._l(t.authInfo,function(i){return e("el-card",{key:i.id,staticClass:"mv-30"},[e("el-row",[e("el-col",{attrs:{span:20}},[e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("公众号微信号：")]),t._v(t._s(i.alias)+"\n            "),""==i.alias?e("small",{staticClass:"gray",staticStyle:{"margin-left":"15px"}},[t._v("你的公众号暂未设置微信号，请设置后重新授权")]):t._e(),t._v(" "),e("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"text"},on:{click:function(i){i.preventDefault(),t.renewbindHandler(i)}}},[t._v("重新授权")]),t._v(" "),e("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"text"},on:{click:function(e){e.preventDefault(),t.unbindHandler(i)}}},[t._v("解除绑定")])],1),t._v(" "),e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("公众号昵称：")]),t._v(t._s(i.nick_name))]),t._v(" "),e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("主体信息：")]),t._v(t._s(i.principal_name))]),t._v(" "),e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("微信账号类型：")]),t._v("\n            "+t._s(-1==i.verify_type?"未认证":"已认证")+t._s(2==i.service_type?"服务号":"订阅号")+"\n            "),-1==i.verify_type?e("el-tooltip",{attrs:{placement:"right-start"}},[e("div",{staticStyle:{"max-width":"350px"},attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"right-title"},[t._v("友情提示：")]),t._v(" "),e("div",{staticClass:"right-text"},[t._v("如果你的公众号已成功升级（从未认证升级为认证号），请点击重新授权")]),t._v(" "),e("div",{staticClass:"right-title"},[t._v("如何升级：")]),t._v(" "),e("div",{staticClass:"right-text right-text-last"},[t._v("\n                  如需对公众号进行微信认证，请登录微信公众平台->公众号设置，在“认证情况”栏目，点击申请微信认证")])]),t._v(" "),e("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px",cursor:"pointer"}})]):t._e()],1),t._v(" "),i.func_info&&i.func_info.length>0?e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("已授权权限：")]),t._v(" "),e("el-button",{attrs:{type:"text"},on:{click:function(e){e.preventDefault(),t.checkJurisdiction(i.func_info)}}},[t._v("查看")])],1):e("div",{staticClass:"text item"},[e("span",{staticClass:"span"},[t._v("权限状态：")]),t._v(" "),e("small",{staticStyle:{color:"#CC6600"}},[t._v("您的公众号已在微信后台取消授权")]),t._v(" "),e("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"text"},on:{click:function(i){i.preventDefault(),t.renewbindHandler(i)}}},[t._v("重新授权")])],1)]),t._v(" "),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e("div",{staticClass:"public-member-avatar mr-20"},[e("iframe",{attrs:{id:"f"+i.id,src:"",frameBorder:"0"}})])])],1)],1)}):[e("el-card",{staticClass:"mv-30"},[e("div",{staticClass:"text-center"},[e("p",{staticClass:"text-999 mh-10"},[t._v("暂无绑定任何微信公众号")]),t._v(" "),e("el-button",{attrs:{type:"text"},on:{click:t.bindHandler}},[t._v("去授权绑定"),e("i",{staticClass:"icon el-icon-arrow-right ml-10"})])],1)])],t._v(" "),e("el-dialog",{attrs:{title:"提示",visible:t.dialogRelieve,width:"30%"},on:{"update:visible":function(i){t.dialogRelieve=i}}},[e("span",{staticClass:"gray"},[t._v("解除绑定微信号，会造成当前店铺的重要信息丢失（包括但不仅限于图文素材、自动回复、自定义菜单、公众号粉丝、分销员客户关系）请谨慎操作")]),t._v(" "),e("div",{staticClass:"relieve-checkbox"},[e("el-checkbox",{attrs:{label:"已知晓解除绑定的风险，确认解绑"},model:{value:t.dbRelieve,callback:function(i){t.dbRelieve=i},expression:"dbRelieve"}})],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{disabled:!t.dbRelieve,type:"primary"},on:{click:t.unbindHandlerDialog}},[t._v("解除绑定")]),t._v(" "),e("el-button",{on:{click:function(i){t.dialogRelieve=!1}}},[t._v("取 消")])],1)]),t._v(" "),e("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.dialogVisible,width:"30%"},on:{"update:visible":function(i){t.$set(t.dialog,"dialogVisible",i)}}},[e("span",[t._v(t._s(t.dialog.content))]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(i){t.confirmDialog(t.dialog.type)}}},[t._v(t._s(t.dialog.confirmText))]),t._v(" "),e("el-button",{on:{click:function(i){t.cancelDialog(t.dialog.type)}}},[t._v(t._s(t.dialog.cancelText))])],1)]),t._v(" "),e("el-dialog",{attrs:{title:"公众号授权权限列表",visible:t.dialogJurisdiction,width:"30%"},on:{"update:visible":function(i){t.dialogJurisdiction=i}}},[e("p",{staticClass:"ju-item"},[t._v("展示公众号已授权给开放平台的权限")]),t._v(" "),e("div",{staticClass:"ju-cont"},t._l(t.ju_list,function(i,n){return e("div",{key:n,staticClass:"item"},["未知"!=i.funcscope_category.name?e("el-tag",{attrs:{type:"success"}},[t._v(t._s(i.funcscope_category.name))]):t._e()],1)}))])],2)},staticRenderFns:[]};var d=e("VU/8")(c,r,!1,function(t){e("3120")},"data-v-53f47526",null);i.default=d.exports},a5cn:function(t,i,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n.text[data-v-53f47526] {\n  font-size: 14px;\n}\n.item[data-v-53f47526] {\n  padding: 5px 0;\n}\n.span[data-v-53f47526] {\n  display: inline-block;\n  min-width: 120px;\n  text-align: right;\n}\n.relieve-checkbox[data-v-53f47526] {\n  margin: 80px 0 0;\n}\n.ju-item[data-v-53f47526] {\n  font-size: 14px;\n  padding: 5px 0;\n}\n.ju-cont[data-v-53f47526] {\n  font-size: 14px;\n  overflow: hidden;\n}\n.ju-cont .item[data-v-53f47526] {\n    display: inline-block;\n    padding: 15px 20px;\n}\n.ju-cont .item span[data-v-53f47526] {\n      display: inline-block;\n      margin-left: 5px;\n}\n.right-title[data-v-53f47526] {\n  font-weight: bold;\n  padding: 15px 10px;\n}\n.right-text[data-v-53f47526] {\n  padding: 0 10px;\n}\n.right-text-last[data-v-53f47526] {\n  padding-bottom: 15px;\n}\n.public-member-avatar[data-v-53f47526] {\n  display: inline-block;\n  width: 120px;\n  height: 120px;\n  line-height: 0;\n}\n.public-member-avatar img[data-v-53f47526] {\n    width: 100%;\n    height: 100%;\n}\n.gray[data-v-53f47526] {\n  color: #909399;\n}\n",""])}});