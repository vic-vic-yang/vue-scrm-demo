webpackJsonp([106],{"/R5v":function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},"29xf":function(n,e,t){var a=t("/R5v");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("11d34ed8",a,!0)},"ni1/":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("Dd8w"),i=t.n(a),r=t("//Fk"),o=t.n(r),s=t("YK4W"),l=t("LiIs"),c=t("0xDb"),p=t("M4fF"),m=t.n(p),u={name:"interpretationList",components:{customElTable:s.a},data:function(){return{tableOptions:[{label:"编号",prop:"id",width:80},{label:"书籍ID",prop:"book_id"},{label:"书籍名称",prop:"name"},{label:"书籍封面",prop:"cover",options:{type:"html"}},{label:"分类",prop:"classify"},{label:"解读人",prop:"explain_name"},{label:"创建时间",prop:"create_time",sortable:!0,width:105,className:"ph-6"},{label:"所属机构",prop:"business_name"},{prop:"USER_ACTION",actions:["edit",{type:"status",options:this.getStatusBtnInfo},"del"]}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,interpretationQueryFrm:{book_name:"",book_classify:"",explain_name:"",time:[],mechanism:"",book_id:""},query:null,classifyOptions:[],mechanismOptions:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-6048e5),n.$emit("pick",[t,e])}},{text:"最近一个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-2592e6),n.$emit("pick",[t,e])}},{text:"最近三个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-7776e6),n.$emit("pick",[t,e])}}]}}},created:function(){var n=this;o.a.all([this.get_mechanism(),this.get_classify(),this.getData()]).then(function(){n.pageLoading=!1}).catch(function(){n.pageLoading=!1})},methods:{getData:function(){var n=this,e=this.query||{};this.tabLoading=!0,l.a.list(i()({page_index:this.pageIndex,page_size:this.pageSize},e)).then(function(e){n.tableData=(e.records||[]).map(function(e,t){return i()({},e,{cover:'<img style="width: 60px;;height: 60px;" src="'+e.cover[0].file_path+'">',create_time:1*e.create_time>0?Object(c.c)(e.create_time):"--",index:n.pageSize*(n.pageIndex-1)+t+1})}),n.totalCount=1*e.totalCount,n.tabLoading=!1}),setTimeout(function(){n.tabLoading=!1},1500)},get_mechanism:function(){var n=this;l.a.mechanism().then(function(e){n.mechanismOptions=e})},get_classify:function(){var n=this;l.a.classify().then(function(e){n.classifyOptions=e})},searchActivityList:function(){this.query=m.a.cloneDeep(this.interpretationQueryFrm);var n=this.query.time||[];this.$set(this.query,"start_time",this.timestamp(n[0])||""),this.$set(this.query,"end_time",this.timestamp(n[1])||""),this.$delete(this.query,"time"),this.pageIndex=1,this.getData()},timestamp:function(n){if(n){var e=n.replace(/-/g,"/");return Date.parse(e)/1e3}return""},createActivity:function(){this.$router.push({name:"readingClubSelectBook"})},editHandler:function(n){this.$router.push({name:"readingClubInterpretationModify",params:{id:n.id}})},deleteHandler:function(n){var e=this,t="确认删除书籍 <b>"+n.name+"</b> 吗？";this.$confirm(t,"删除",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.del({id:n.id}).then(function(){e.getData()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},actionHandler:function(n,e){var t=this;if("status"===n){var a=this.getStatusBtnInfo(e).label,i="确认"+a+"书籍 <b>"+e.name+"</b> 吗？";if(1*e.status==0)1*e.can_disable==1&&(i="有书籍正在进行当中，"+i);else if(1*e.enable_status==2)return this.$alert("活动时间已结束，请编辑后再启用。","提示",{confirmButtonText:"知道了"});this.$confirm(i,a,{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.status({id:e.id,status:1*e.status==1?"0":"1"}).then(function(){t.getData()})}).catch(function(){t.$message({type:"info",message:"已取消"+a})})}},sizeChangeHandler:function(n){this.pageSize=n,this.pageIndex=1,this.getData()},pageChangeHandler:function(n){this.pageIndex=n,this.getData()},getStatusBtnInfo:function(n){return n?0===1*n.status?{btn:"danger",label:"禁用"}:{btn:"primary",label:"启用"}:{btn:"danger",label:"禁用"}},resetForm:function(n){this.$refs[n].resetFields()}}},d={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"control-group"},[t("el-form",{ref:"interpretationQueryFrm",attrs:{inline:!0,model:n.interpretationQueryFrm}},[t("el-form-item",{attrs:{prop:"book_name",label:"书籍名称"}},[t("el-input",{attrs:{placeholder:"书籍名称"},model:{value:n.interpretationQueryFrm.book_name,callback:function(e){n.$set(n.interpretationQueryFrm,"book_name",e)},expression:"interpretationQueryFrm.book_name"}})],1),n._v(" "),t("el-form-item",{attrs:{prop:"book_classify",label:"分类"}},[t("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:n.interpretationQueryFrm.book_classify,callback:function(e){n.$set(n.interpretationQueryFrm,"book_classify",e)},expression:"interpretationQueryFrm.book_classify"}},n._l(n.classifyOptions,function(n){return t("el-option",{key:n.name,attrs:{label:n.name,value:n.name}})}))],1),n._v(" "),t("el-form-item",{attrs:{prop:"explain_name",label:"解读人"}},[t("el-input",{attrs:{placeholder:"解读人"},model:{value:n.interpretationQueryFrm.explain_name,callback:function(e){n.$set(n.interpretationQueryFrm,"explain_name",e)},expression:"interpretationQueryFrm.explain_name"}})],1),n._v(" "),t("el-form-item",{attrs:{prop:"time",label:"创建时间"}},[t("el-date-picker",{attrs:{editable:!1,type:"datetimerange","picker-options":n.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss",align:"right"},model:{value:n.interpretationQueryFrm.time,callback:function(e){n.$set(n.interpretationQueryFrm,"time",e)},expression:"interpretationQueryFrm.time"}})],1),n._v(" "),t("el-form-item",{attrs:{prop:"mechanism",label:"所属机构"}},[t("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:n.interpretationQueryFrm.mechanism,callback:function(e){n.$set(n.interpretationQueryFrm,"mechanism",e)},expression:"interpretationQueryFrm.mechanism"}},n._l(n.mechanismOptions,function(n){return t("el-option",{key:n.business_name,attrs:{label:n.business_name,value:n.business_name}})}))],1),n._v(" "),t("el-form-item",{attrs:{prop:"book_id",label:"书籍ID"}},[t("el-input",{attrs:{placeholder:"书籍ID"},model:{value:n.interpretationQueryFrm.book_id,callback:function(e){n.$set(n.interpretationQueryFrm,"book_id",e)},expression:"interpretationQueryFrm.book_id"}})],1),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:n.searchActivityList}},[n._v("查询")]),n._v(" "),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(e){n.resetForm("interpretationQueryFrm")}}},[n._v("重置")])],1),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:n.createActivity}},[t("i",{staticClass:"fs-13 el-icon-plus mr-5"}),n._v("新建解读\n        ")])],1)],1)],1),n._v(" "),t("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.tabLoading,expression:"tabLoading"}],attrs:{tableData:n.tableData,tableOptions:n.tableOptions,total:n.totalCount},on:{edit:n.editHandler,delete:n.deleteHandler,action:n.actionHandler,"size-change":n.sizeChangeHandler,"page-change":n.pageChangeHandler},model:{value:n.pageIndex,callback:function(e){n.pageIndex=e},expression:"pageIndex"}})],1)},staticRenderFns:[]};var f=t("VU/8")(u,d,!1,function(n){t("29xf")},"data-v-43971f8c",null);e.default=f.exports}});