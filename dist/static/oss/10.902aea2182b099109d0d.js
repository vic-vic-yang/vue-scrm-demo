webpackJsonp([10],{"818O":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.article_pages[data-v-6297a09e]{\n  text-align: right;\n  margin: 5px 0 0;\n}\n.wrapper[data-v-6297a09e]{\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n",""])},SD4S:function(t,e,a){var i=a("818O");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("3ad3a2e4",i,!0)},X9gy:function(t,e,a){"use strict";var i=a("gyMJ");e.a={list:function(t){return i.a.get("/integral/v1/lottery/actives",{params:t}).then(function(t){return t.data})},get:function(t){return i.a.get("/integral/v1/lottery/actives/"+t.id)},add:function(t){return i.a.post("/integral/v1/lottery/actives",t,{autoShowMessage:!0})},edit:function(t){return i.a.put("/integral/v1/lottery/actives/"+t.id,t,{autoShowMessage:!0,showMessageType:"put"})},del:function(t){return i.a.delete("/integral/v1/lottery/actives/"+t.id,{autoShowMessage:!0})},status:function(t){return i.a.put("/integral/v1/lottery/actives/"+t.id+"/status/"+t.status,t,{autoShowMessage:!0,showMessageType:"put"})},getType:function(){return i.a.get("/integral/v1/lottery/active/get-type")}}},rMuz:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),r=a.n(i),n=a("5aCZ"),l=a("X9gy"),o=a("LLsu"),c=a("M4fF"),s=a.n(c),p={name:"activity_create",components:{uploadPrizeAvatar:a("QbVN").a,Tinymce:n.a},data:function(){return{pageLoading:!0,action:this.$route.params.id?"modify":"add",activityFrm:{id:this.$route.params.id||0,type_id:1,active_open_time:"",active_open_num:"",name:"",active_time:[],avatar:"",desc:"",rule_id:"",integral:""},frmRules:{active_open_num:[{required:!0,message:"请选择开奖人数"}],active_open_time:[{required:!0,message:"请选择活动开奖时间"}],avatar:[{required:!0,message:"请上传活动图片"}],type_id:[{required:!0,message:"请选择活动形式"}],name:[{required:!0,message:"请输入活动名称"}],active_time:[{required:!0,message:"请选择活动有效期"}],rule_id:[{required:!0,message:"请选择活动规则"}],integral:[{required:!0,message:"请输入每次参与消耗积分额"}]},formOptions:[{id:1,name:"按时间开奖"},{id:2,name:"按人数开奖"},{id:3,name:"跑马灯"}],ruleOptions:[],pageIndex:1,pageSize:10,totalCount:0,startPickerOptions:{disabledDate:function(t){var e=new Date;return+t<+new Date(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" 00:00")}}}},created:function(){this.getType(),this.getRule(),this.getDetail()},methods:{getDetail:function(){var t=this;if("add"===this.action)return this.pageLoading=!1;l.a.get({id:this.activityFrm.id}).then(function(e){t.activityFrm=s.a.assign({},t.activityFrm,e.data),t.activityFrm.rule_id=t.activityFrm.rule_id+"",t.activityFrm.active_time.push(e.data.start_time),t.activityFrm.active_time.push(e.data.end_time),t.pageLoading=!1}).catch(function(){t.pageLoading=!1})},getRule:function(){var t=this;o.a.list({page_index:this.pageIndex,page_size:this.pageSize}).then(function(e){t.ruleOptions=(e.result||[]).map(function(t){return{id:t.id,name:t.name}}),t.totalCount=1*e.totalCount})},getType:function(){l.a.getType().then(function(t){})},currentChangeRule:function(t){this.pageIndex=t,this.getRule()},save:function(){var t=this;this.$refs.activityFrm.validate(function(e){if(e){var a=r()({},t.activityFrm);a.start_time=a.active_time[0],a.end_time=a.active_time[1],("modify"===t.action?l.a.edit(a):l.a.add(a)).then(function(){t.$router.back()})}})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"app-container"},[a("el-form",{ref:"activityFrm",staticClass:"activity-edit__form",attrs:{model:t.activityFrm,rules:t.frmRules,"label-width":"140px"}},[a("el-form-item",{attrs:{prop:"type_id",label:"活动形式"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择活动形式"},model:{value:t.activityFrm.type_id,callback:function(e){t.$set(t.activityFrm,"type_id",e)},expression:"activityFrm.type_id"}},t._l(t.formOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{prop:"name",label:"活动名称"}},[a("el-input",{attrs:{placeholder:"请输入活动名称"},model:{value:t.activityFrm.name,callback:function(e){t.$set(t.activityFrm,"name",e)},expression:"activityFrm.name"}})],1),t._v(" "),3!==t.activityFrm.type_id?a("el-form-item",{attrs:{prop:"avatar",label:"活动图片"}},[a("upload-prize-avatar",{model:{value:t.activityFrm.avatar,callback:function(e){t.$set(t.activityFrm,"avatar",e)},expression:"activityFrm.avatar"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{prop:"active_time",label:"活动有效期"}},[a("el-date-picker",{attrs:{editable:!1,type:"datetimerange","picker-options":t.startPickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.activityFrm.active_time,callback:function(e){t.$set(t.activityFrm,"active_time",e)},expression:"activityFrm.active_time"}})],1),t._v(" "),1===t.activityFrm.type_id?a("el-form-item",{attrs:{prop:"active_open_time",label:"开奖时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.activityFrm.active_open_time,callback:function(e){t.$set(t.activityFrm,"active_open_time",e)},expression:"activityFrm.active_open_time"}})],1):t._e(),t._v(" "),2===t.activityFrm.type_id?a("el-form-item",{attrs:{prop:"active_open_num",label:"开奖人数"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.activityFrm.active_open_num,callback:function(e){t.$set(t.activityFrm,"active_open_num",e)},expression:"activityFrm.active_open_num"}},[a("template",{slot:"append"},[t._v("人")])],2)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{prop:"desc",label:"活动说明"}},[a("tinymce",{attrs:{placeholder:"请输入活动说明",height:300},model:{value:t.activityFrm.desc,callback:function(e){t.$set(t.activityFrm,"desc",e)},expression:"activityFrm.desc"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"rule_id",label:"活动规则"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择活动规则"},model:{value:t.activityFrm.rule_id,callback:function(e){t.$set(t.activityFrm,"rule_id",e)},expression:"activityFrm.rule_id"}},[t._l(t.ruleOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),t._v(" "),a("div",{staticClass:"article_pages"},[a("el-pagination",{attrs:{"page-size":t.pageSize,"pager-count":Math.ceil(t.totalCount/t.pageSize),"current-page":t.pageIndex,layout:"prev, pager, next",total:t.totalCount},on:{"current-change":t.currentChangeRule}})],1)],2)],1),t._v(" "),a("el-form-item",{attrs:{prop:"integral",label:"每次参与消耗积分额"}},[a("el-input-number",{attrs:{min:0,placeholder:"请输入每次参与消耗积分额",name:"integral"},model:{value:t.activityFrm.integral,callback:function(e){t.$set(t.activityFrm,"integral",e)},expression:"activityFrm.integral"}}),t._v(" "),a("span",{staticClass:"ml-5 text-666"},[t._v("积分")])],1),t._v(" "),a("el-form-item",{attrs:{prop:"hot",label:"虚拟参与人气值"}},[a("div",{staticClass:"wrapper"},[a("el-input",{attrs:{placeholder:"虚拟参与人气值"},model:{value:t.activityFrm.hot,callback:function(e){t.$set(t.activityFrm,"hot",e)},expression:"activityFrm.hot"}}),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可更改抽奖活动详情页面“已参与人数的显示”",placement:"top-end"}},[a("el-button",[t._v("?")])],1)],1)]),t._v(" "),a("el-form-item",[a("el-button",{on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.$router.back()}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.save(e)}}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(p,m,!1,function(t){a("SD4S")},"data-v-6297a09e",null);e.default=u.exports}});