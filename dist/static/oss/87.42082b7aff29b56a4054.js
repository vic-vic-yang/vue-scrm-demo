webpackJsonp([87],{X69J:function(e,t,i){var a=i("gJ1e");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("65ecf2a6",a,!0)},gJ1e:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"\n.activity-qr[data-v-79d24dae] {\n  width: 150px;\n  height: 150px;\n  line-height: 0;\n  overflow: hidden;\n}\n.activity-qr > img[data-v-79d24dae] {\n    width: 100%;\n    height: 100%;\n}\n",""])},thye:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("YK4W"),n=i("SFyP"),s=i("0xDb"),r=i("M4fF"),o=i.n(r),l={name:"lotteryList",components:{customElTable:a.a},data:function(){return{tableOptions:[{label:"ID",prop:"id",width:"50"},{label:"活动标题",prop:"name"},{label:"对应规则",prop:"lottery_rule_name"},{label:"状态",prop:"statusTxt",options:{type:"tag",prop:"status"}},{label:"关联码段",prop:"code_num"},{label:"创建时间",prop:"create_time",sortable:!0,width:105,className:"ph-6"},{prop:"USER_ACTION",actions:["edit",{type:"record",label:"中奖纪录"},{type:"preview",label:"预览"}]}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,previewDialogVisible:!1,previewActivity:{},previewImgLoading:!0}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.tabLoading=!0,n.a.list({pageIndex:this.pageIndex,pageSize:this.pageSize}).then(function(t){e.tableData=(t.result||[]).map(function(e){return o.a.merge(e,{code_num:e.code_id?e.code_id.split(",").length:0,statusTxt:["停用","启用"][e.status],create_time:Object(s.c)(e.create_time)})}),e.totalCount=1*t.totalCount,e.tabLoading=!1}).catch(function(){e.tabLoading=!1})},createLotteryActivity:function(){this.$router.push({name:"lotteryActivityCreate"})},copyPreviewUrl:function(){var e=this;this.$copyText(this.previewActivity.url).then(function(){e.$message({message:"复制成功",type:"success"})},function(){e.$message({message:"复制失败",type:"error"})})},actionHandler:function(e,t){var i=this;"preview"===e?n.a.preview(t.id).then(function(e){i.previewActivity=e,i.previewImgLoading=!0,i.previewDialogVisible=!0}):"record"===e&&this.$router.push({name:"activityAwardRecord",params:{activityId:t.id}})},editHandler:function(e){this.$router.push({name:"lotteryActivityModify",params:{id:e.id}})},sizeChangeHandler:function(e){this.pageSize=e,this.pageIndex=1,this.getData()},pageChangeHandler:function(e){this.pageIndex=e,this.getData()}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"control-group mb-20"},[i("el-button",{attrs:{type:"primary"},on:{click:e.createLotteryActivity}},[i("i",{staticClass:"el-icon-plus mr-5 fs-13"}),e._v(" 新建活动\n    ")])],1),e._v(" "),i("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],attrs:{tableData:e.tableData,tableOptions:e.tableOptions,total:e.totalCount},on:{action:e.actionHandler,edit:e.editHandler,"size-change":e.sizeChangeHandler,"page-change":e.pageChangeHandler},model:{value:e.pageIndex,callback:function(t){e.pageIndex=t},expression:"pageIndex"}}),e._v(" "),i("el-dialog",{staticClass:"activity-preview-dialog",attrs:{title:"活动预览",visible:e.previewDialogVisible},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[i("div",{staticClass:"preview-wrapper mb-30 ph-20"},[i("p",{staticClass:"fs-16"},[e._v("活动链接：")]),e._v(" "),i("div",{staticClass:"d-flex flex-justify-space flex-align-center"},[i("div",{staticClass:"flex-box-autoFix"},[i("el-input",{attrs:{disabled:""},model:{value:e.previewActivity.url,callback:function(t){e.$set(e.previewActivity,"url",t)},expression:"previewActivity.url"}})],1),e._v(" "),i("el-button",{staticClass:"ml-10 d-block",attrs:{slot:"append",type:"primary"},on:{click:e.copyPreviewUrl},slot:"append"},[e._v("复制")])],1),e._v(" "),i("p",{staticClass:"fs-16"},[e._v("扫码二维码访问")]),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.previewImgLoading,expression:"previewImgLoading"}],staticClass:"activity-qr"},[i("img",{attrs:{src:e.previewActivity.image},on:{load:function(t){e.previewImgLoading=!1},error:function(t){e.previewImgLoading=!1}}})])])])],1)},staticRenderFns:[]};var p=i("VU/8")(l,c,!1,function(e){i("X69J")},"data-v-79d24dae",null);t.default=p.exports}});