webpackJsonp([150],{Q098:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),n=a.n(i),l=a("YK4W"),r=a("Djz4"),s=a("0xDb"),o=a("M4fF"),c=a.n(o),u={name:"contentActivity",components:{customElTable:l.a},data:function(){return{activityQueryFrm:{title:"",time:[],state:""},query:null,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},stateOptions:[{value:0,label:"已禁用"},{value:1,label:"进行中"},{value:2,label:"未开始"},{value:3,label:"已结束"}],tableOptions:[{label:"序号",prop:"id",width:120},{label:"活动标题",prop:"activity_name"},{label:"参与人数",prop:"players",width:120},{label:"开始时间",prop:"start_time",sortable:!0,width:155,className:"ph-6"},{label:"结束时间",prop:"end_time",sortable:!0,width:155,className:"ph-6"},{label:"状态",prop:"status_cn",width:120,options:{type:"tag",prop:"status"}},{prop:"USER_ACTION",actions:["edit",{type:"status",options:this.getStatusBtnInfo},"del",{type:"signUp",label:"报名管理"}]}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0}},created:function(){this.getData()},methods:{getData:function(){var t=this,e=this.query||{};this.tabLoading=!0,r.a.activity.list(n()({pageIndex:this.pageIndex,pageSize:this.pageSize},e)).then(function(e){e.result.forEach(function(t){t.start_time&&(t.start_time=Object(s.c)(t.start_time)),t.end_time&&(t.end_time=Object(s.c)(t.end_time))}),t.tableData=e.result,t.totalCount=1*e.totalCount,t.tabLoading=!1}).catch(function(){t.tabLoading=!1})},searchActivity:function(){var t=c.a.cloneDeep(this.activityQueryFrm),e=t.title,a=t.time,i=t.state;this.query={activityName:e,status:i,startTime:"",endTime:""},a&&a.length>1&&(this.query.startTime=a[0],this.query.endTime=a[1]),this.pageIndex=1,this.getData()},createActivity:function(){this.$router.push({name:"contentAddActivity"})},actionHandler:function(t,e){var a=this;"status"===t?this.$confirm("确认"+(0===e.status?"启用":"禁用")+"活动 <b>"+e.activity_name+"</b> 吗？",0===e.status?"启用":"禁用",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.activity.status(e.id).then(function(){a.getData()})}).catch(function(){a.$message({type:"info",message:"已取消"})}):"signUp"===t&&this.$router.push({name:"contentSignUp",params:{id:e.id}})},editHandler:function(t){this.$router.push({name:"contentEditorActivity",params:{id:t.id}})},deleteHandler:function(t){var e=this;this.$confirm("确认删除 <b>"+t.activity_name+"</b> 吗？","删除",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.activity.del(t.id).then(function(){e.getData()})}).catch(function(){e.$message({type:"info",message:"已取消"})})},getStatusBtnInfo:function(t){if(!t)return{btn:"danger",label:"禁用"};var e=1*t.status;return{btn:0===e?"primary":"danger",label:0===e?"启用":"禁用"}},sizeChangeHandler:function(t){this.pageSize=t,this.pageIndex=1,this.getData()},pageChangeHandler:function(t){this.pageIndex=t,this.getData()}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"control-group"},[a("el-form",{attrs:{inline:!0,model:t.activityQueryFrm}},[a("el-form-item",{attrs:{label:"活动名称"}},[a("el-input",{attrs:{placeholder:"活动名称"},model:{value:t.activityQueryFrm.title,callback:function(e){t.$set(t.activityQueryFrm,"title",e)},expression:"activityQueryFrm.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动状态"}},[a("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:t.activityQueryFrm.state,callback:function(e){t.$set(t.activityQueryFrm,"state",e)},expression:"activityQueryFrm.state"}},t._l(t.stateOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"活动时间"}},[a("el-date-picker",{attrs:{editable:!1,type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss",align:"right"},model:{value:t.activityQueryFrm.time,callback:function(e){t.$set(t.activityQueryFrm,"time",e)},expression:"activityQueryFrm.time"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchActivity}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.createActivity}},[a("i",{staticClass:"fs-13 el-icon-plus mr-5"}),t._v("新建活动\n        ")])],1)],1)],1),t._v(" "),a("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tabLoading,expression:"tabLoading"}],attrs:{tableData:t.tableData,tableOptions:t.tableOptions,total:t.totalCount},on:{edit:t.editHandler,delete:t.deleteHandler,action:t.actionHandler,"size-change":t.sizeChangeHandler,"page-change":t.pageChangeHandler},model:{value:t.pageIndex,callback:function(e){t.pageIndex=e},expression:"pageIndex"}})],1)},staticRenderFns:[]},m=a("VU/8")(u,p,!1,null,null,null);e.default=m.exports}});