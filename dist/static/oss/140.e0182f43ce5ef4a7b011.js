webpackJsonp([140],{"7L9I":function(e,t,a){var i=a("pDUU");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("3b563348",i,!0)},pDUU:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.text[data-v-00815fbf] {\n  width: 80%;\n}\n",""])},q4iv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),s=a.n(i),n=a("//Fk"),r=a.n(n),l=a("YK4W"),o=a("afCy"),d=a("LHg1"),p=a("xzVI"),c=a("0xDb"),g={name:"gameDetail",components:{customElTable:l.a,DetailCard:o.a,userDetailModal:d.a},data:function(){return{gameId:this.$route.params.gameId,gameDetail:{},tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,pageLoading:!0,userDetailInfo:{},rewardUsers:{id:"",money:"",ranking:"",appid:""},userDetailDialog:!1,dialogVisible:!1,appIdList:[]}},computed:{gameMatchType:function(){return this.gameDetail?this.gameDetail.matchType-0:1},tableOptions:function(){return[{label:"编号",prop:"id",width:80},{label:1===this.gameMatchType?"用户名称":"团队名称",prop:"name"},{label:"排行",prop:"ranking"},{label:"积分",prop:"score"},{prop:"USER_ACTION",actions:[{label:"查看详情",type:"detail"},{type:"status",options:this.getStatusBtnInfo},{label:"发奖",type:"prizes",disableds:this.ifDisableds}]}]}},created:function(){var e=this;r.a.all([p.a.get(this.gameId),this.getData(),this.getAppIdList()]).then(function(t){var a=t[0];a.matchModeTxt=e.$store.getters.getMatchMode(a.matchMode),a.matchTypeTxt=e.$store.getters.getMatchType(a.matchType),e.gameDetail=a,e.pageLoading=!1}).catch(function(){e.pageLoading=!1})},methods:{getData:function(){var e=this;return this.tabLoading=!0,p.a.rank(this.gameId,{pageIndex:this.pageIndex,pageSize:this.pageSize}).then(function(t){return e.tableData=(t.items||[]).map(function(e){return s()({},e,{id:e.player.id,playerId:e.id,name:e.player.name,createTime:Object(c.c)(e.createTime)})}),e.totalCount=1*t.totalCount,e.tabLoading=!1,t}).catch(function(t){return e.tabLoading=!1,r.a.reject(t)})},getAppIdList:function(){var e=this;p.a.appIdList().then(function(t){e.appIdList=t.data})},actionHandler:function(e,t){var a=this;if("detail"===e)1===this.gameMatchType?(this.userDetailInfo={userName:t.name,userId:t.id},this.userDetailDialog=!0):2===this.gameMatchType&&this.$router.push({name:"teamDetail",params:{id:t.id}});else if("prizes"===e)this.rewardUsers={id:t.playerId,ranking:t.ranking},this.dialogVisible=!0;else if("status"===e){var i=t.status-0==0?"已发":"未发";this.$confirm("确认修改为"+i+"吗？",t.statusTxt,{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){p.a.revise({id:t.playerId}).then(function(e){200===e.code&&(a.getData(),a.$message({type:"success",message:"已修改"}))})}).catch(function(){a.$message({type:"info",message:"已取消"})})}},sizeChangeHandler:function(e){this.pageSize=e,this.pageIndex=1,this.getData()},pageChangeHandler:function(e){this.pageIndex=e,this.getData()},cancel:function(){this.dialogVisible=!1},save:function(){var e=this;p.a.prizes(this.rewardUsers).then(function(t){200===t.code&&(e.getData(),e.$message({type:"success",message:"奖金发放成功"}))}),this.dialogVisible=!1},getStatusBtnInfo:function(e){return e?{btn:1*e.status==0?"primary":"danger",label:1*e.status==0?"未发":"已发"}:{btn:"danger",label:"已发"}},ifDisableds:function(e){if(!e)return!1;var t=!0;return 1*e.status==0&&(t=!1),t}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"app-container"},[a("detail-card",{attrs:{title:e.gameDetail.matchName}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"item-detail-content"},[a("p",[e._v("游戏模式 : "+e._s(e.gameDetail.matchModeTxt))])])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"item-detail-content"},[a("p",[e._v("比赛模式 : "+e._s(e.gameDetail.matchTypeTxt))])])])],1)],1),e._v(" "),a("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],attrs:{tableData:e.tableData,tableOptions:e.tableOptions,total:e.totalCount},on:{action:e.actionHandler,"size-change":e.sizeChangeHandler,"page-change":e.pageChangeHandler},model:{value:e.pageIndex,callback:function(t){e.pageIndex=t},expression:"pageIndex"}}),e._v(" "),a("user-detail-modal",{attrs:{detail:e.userDetailInfo,show:e.userDetailDialog},on:{"update:show":function(t){e.userDetailDialog=t}}}),e._v(" "),a("el-dialog",{attrs:{title:"提示",width:"470px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"rewardUsers",attrs:{model:e.rewardUsers,"label-width":"60px"}},[a("el-form-item",{attrs:{prop:"appid",label:"小程序"}},[a("el-select",{attrs:{placeholder:"请选择小程序"},model:{value:e.rewardUsers.appid,callback:function(t){e.$set(e.rewardUsers,"appid",t)},expression:"rewardUsers.appid"}},e._l(e.appIdList,function(e){return a("el-option",{key:e.authorizer_appid,attrs:{label:e.nick_name,value:e.authorizer_appid}})}))],1),e._v(" "),a("el-form-item",{attrs:{prop:"money",label:"金额"}},[a("el-input",{staticClass:"text",attrs:{placeholder:"请输入内容"},model:{value:e.rewardUsers.money,callback:function(t){e.$set(e.rewardUsers,"money",t)},expression:"rewardUsers.money"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"ranking",label:"排名"}},[a("el-input",{staticClass:"text",attrs:{placeholder:"请输入内容"},model:{value:e.rewardUsers.ranking,callback:function(t){e.$set(e.rewardUsers,"ranking",t)},expression:"rewardUsers.ranking"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(g,u,!1,function(e){a("7L9I")},"data-v-00815fbf",null);t.default=m.exports}});