webpackJsonp([112],{"46vC":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"",""])},cDDx:function(e,t,a){var i=a("46vC");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("ae76d8e4",i,!0)},jDq5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),r=a.n(i),l=a("Dd8w"),s=a.n(l),n=a("//Fk"),d=a.n(n),o=a("YK4W"),p=a("h9qX"),c=a("SFyP"),m=a("0xDb"),_=a("M4fF"),v=a.n(_),u={name:"awardRecord",components:{customElTable:o.a},data:function(){return{tableOptions:[{label:"ID",prop:"id",width:"50"},{label:"活动名称",prop:"activity_name"},{label:"中奖规则",prop:"rule_name"},{label:"奖品类型",prop:"prize_type_name"},{label:"奖项等级",prop:"prize_level_name"},{label:"奖品/金额(元)",prop:"prize_info"},{label:"发货状态",prop:"deliver_status_text",options:{type:"tag",prop:"deliver_status"}},{label:"用户ID",prop:"user_id"},{label:"记录时间",prop:"prize_time",sortable:!0,width:105,className:"ph-6"}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,pageLoading:!0,previewDialogVisible:!1,previewRecord:{},activityMenuOptions:[],statusOptions:[{value:0,label:"所有"},{value:1,label:"已发货"},{value:2,label:"待发货"}],prizeTemplateOptions:[],searchFrm:{activity_id:1*this.$route.params.activityId,prize_type:0,is_send:0,prize_template_id:0,start_date:"",end_date:""},searchQuery:{activity_id:1*this.$route.params.activityId,prize_type:0,is_send:0,prize_template_id:0,start_date:"",end_date:""},deliverFrm:{is_send:1,expressage:"",expressage_code:"",send_time:""}}},created:function(){var e=this;d.a.all([c.a.selectList(),p.b.selectList(0),this.getData()]).then(function(t){t[1].unshift({id:0,name:"全部"}),e.activityMenuOptions=t[0],e.prizeTemplateOptions=t[1],e.pageLoading=!1})},methods:{getData:function(){var e=this;this.tabLoading=!0;var t=v.a.assign({},this.searchQuery);return""!==t.start_date&&(t.start_date/=1e3),""!==t.end_date&&(t.end_date/=1e3),c.a.awardRecord(s()({pageIndex:this.pageIndex,pageSize:this.pageSize},t)).then(function(t){return e.tableData=(t.result||[]).map(function(t){var a=t.deliver_msg?1*t.deliver_msg.is_send:2;return v.a.merge(t,{prize_type_name:e.$store.getters.getPrizeType(t.prize_type).label,prize_info:t.prize_name+" / "+t.prize_price+"元",deliver_status:1===a?1:0,deliver_status_text:1===a?"已发货":"待发货",prize_time:Object(m.c)(t.prize_time)})}),e.totalCount=1*t.totalCount,e.tabLoading=!1,t}).catch(function(t){return e.tabLoading=!1,t})},tabCellClickHandler:function(e,t){if("deliver_status_text"===e){this.previewRecord=t;var a=t.deliver_msg;this.deliverFrm=a?{is_send:1*a.is_send,expressage:a.expressage,expressage_code:a.expressage_code,send_time:a.send_time||""}:{is_send:2,expressage:"",expressage_code:"",send_time:""},this.previewDialogVisible=!0}},sizeChangeHandler:function(e){this.pageSize=e,this.pageIndex=1,this.getData()},pageChangeHandler:function(e){this.pageIndex=e,this.getData()},searchAwardRecord:function(){this.searchQuery=r()({},this.searchFrm),this.getData()},prizeTypeChange:function(e){var t=this;p.b.selectList(e).then(function(e){e.unshift({id:"",name:"全部"}),t.prizeTemplateOptions=e})},deliverManageHandler:function(){var e=this,t=r()({},this.deliverFrm);t.prize_record_id=this.previewRecord.id,""!==t.send_time&&(t.send_time/=1e3),c.a.deliverManagement(t).then(function(){e.getData(),e.previewRecord={},e.previewDialogVisible=!1})}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"app-container"},[a("div",{staticClass:"control-group"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"活动名称"},model:{value:e.searchFrm.activity_id,callback:function(t){e.$set(e.searchFrm,"activity_id",t)},expression:"searchFrm.activity_id"}},e._l(e.activityMenuOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.act_name,value:1*e.id}})}))],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"奖品类型"},on:{change:e.prizeTypeChange},model:{value:e.searchFrm.prize_type,callback:function(t){e.$set(e.searchFrm,"prize_type",t)},expression:"searchFrm.prize_type"}},e._l(e.$store.getters.prizeTypeFilterOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"发货状态"},model:{value:e.searchFrm.is_send,callback:function(t){e.$set(e.searchFrm,"is_send",t)},expression:"searchFrm.is_send"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"奖品"},model:{value:e.searchFrm.prize_template_id,callback:function(t){e.$set(e.searchFrm,"prize_template_id",t)},expression:"searchFrm.prize_template_id"}},e._l(e.prizeTemplateOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",editable:!1,"value-format":"timestamp",format:"yyyy-MM-dd HH:mm",placeholder:"开始日期","default-time":"12:00:00"},model:{value:e.searchFrm.start_date,callback:function(t){e.$set(e.searchFrm,"start_date",t)},expression:"searchFrm.start_date"}})],1),e._v(" "),a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",editable:!1,"value-format":"timestamp",format:"yyyy-MM-dd HH:mm",placeholder:"结束日期","default-time":"12:00:00"},model:{value:e.searchFrm.end_date,callback:function(t){e.$set(e.searchFrm,"end_date",t)},expression:"searchFrm.end_date"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchAwardRecord}},[e._v("查询")])],1)],1)],1),e._v(" "),a("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],attrs:{tableData:e.tableData,tableOptions:e.tableOptions,total:e.totalCount},on:{"size-change":e.sizeChangeHandler,"page-change":e.pageChangeHandler,"cell-click":e.tabCellClickHandler},model:{value:e.pageIndex,callback:function(t){e.pageIndex=t},expression:"pageIndex"}}),e._v(" "),a("el-dialog",{staticClass:"deliver-preview-dialog",attrs:{title:"发货管理",visible:e.previewDialogVisible},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[a("el-form",{attrs:{model:e.deliverFrm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio",{attrs:{label:1},model:{value:e.deliverFrm.is_send,callback:function(t){e.$set(e.deliverFrm,"is_send",t)},expression:"deliverFrm.is_send"}},[e._v("已发货\n        ")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.deliverFrm.is_send,callback:function(t){e.$set(e.deliverFrm,"is_send",t)},expression:"deliverFrm.is_send"}},[e._v("未发货\n        ")])],1),e._v(" "),a("el-form-item",{attrs:{label:"物流公司"}},[a("el-input",{attrs:{name:"expressage",placeholder:"物流公司"},model:{value:e.deliverFrm.expressage,callback:function(t){e.$set(e.deliverFrm,"expressage",t)},expression:"deliverFrm.expressage"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"物流单号"}},[a("el-input",{attrs:{name:"expressage_code",placeholder:"物流单号"},model:{value:e.deliverFrm.expressage_code,callback:function(t){e.$set(e.deliverFrm,"expressage_code",t)},expression:"deliverFrm.expressage_code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发货日期"}},[a("el-date-picker",{attrs:{type:"datetime",editable:!1,"value-format":"timestamp",format:"yyyy-MM-dd HH:mm",placeholder:"发货日期","default-time":"12:00:00"},model:{value:e.deliverFrm.send_time,callback:function(t){e.$set(e.deliverFrm,"send_time",t)},expression:"deliverFrm.send_time"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.deliverManageHandler}},[e._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(u,g,!1,function(e){a("cDDx")},"data-v-39887dc7",null);t.default=h.exports}});