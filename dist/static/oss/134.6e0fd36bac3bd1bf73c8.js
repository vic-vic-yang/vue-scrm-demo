webpackJsonp([134],{"4Nt9":function(n,t,e){var a=e("8JAH");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("1ea86d9a",a,!0)},"8JAH":function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},TfhL:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Dd8w"),s=e.n(a),i=e("YK4W"),o=e("sF3O"),r=e("0xDb"),l=e("NYxO"),u={name:"gameList",components:{customElTable:i.a},data:function(){return{stageId:this.$route.params.stageId,tableOptions:[{label:"编号",prop:"id",width:80},{label:"任务序号",prop:"num",width:80},{label:"任务名称",prop:"mission_name"},{label:"参与人数",prop:"players"},{label:"创建时间",prop:"create_time",sortable:!0,className:"ph-6"},{label:"任务状态",prop:"status_cn",options:{type:"tag",prop:"stageType"}},{prop:"USER_ACTION",actions:["edit",{type:"status",options:this.getStatusBtnInfo},"del",{type:"moveTopTask",options:this.getTaskTopBtnInfo,disableds:this.ifTopDisabled},{type:"moveButtomTask",options:this.getTasButtomkBtnInfo,disableds:this.ifButtomDisabled}]}],tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!1,query:null,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-6048e5),n.$emit("pick",[e,t])}},{text:"最近一个月",onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-2592e6),n.$emit("pick",[e,t])}},{text:"最近三个月",onClick:function(n){var t=new Date,e=new Date;e.setTime(e.getTime()-7776e6),n.$emit("pick",[e,t])}}]}}},created:function(){this.getData()},computed:s()({},Object(l.c)({matchModeOptions:function(n){return n.game.matchMode},matchTypeOptions:function(n){return n.game.matchType}})),methods:{getData:function(){var n=this;this.tabLoading=!0,o.a.task.list(this.stageId,{pageIndex:this.pageIndex,pageSize:this.pageSize}).then(function(t){t.result.forEach(function(n,e){n.create_time=Object(r.c)(n.create_time),n.status_cn=n.status-0==0?"禁用":n.status_cn,n.stageType="已结束"===n.status_cn?1:"进行中"===n.status_cn?3:0,n.num=e+1,n.ifTopDisabled=!1,n.ifButtomDisabled=!1,0===e?n.ifTopDisabled=!0:e===t.result.length-1&&(n.ifButtomDisabled=!0)}),n.tableData=t.result,n.totalCount=1*t.totalCount,n.tabLoading=!1})},createGame:function(){this.$router.push({name:"voteNewStage"})},editHandler:function(n){this.$router.push({name:"voteEditorTask",params:{id:n.id}})},deleteHandler:function(n){var t=this;this.$confirm("确认删除任务 <b>"+n.mission_name+"</b> 吗？","删除",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.task.del(t.stageId,n.id).then(function(){t.getData()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},actionHandler:function(n,t){var e=this;if("status"===n){var a=this.$store.getters.getStatusTxt(!(1*t.status));this.$confirm("确认"+a+"任务 <b>"+t.mission_name+"</b> 吗？",a,{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.task.status(e.stageId,t.id).then(function(){e.getData(),e.$message({type:"success",message:"修改成功"})})}).catch(function(){e.$message({type:"info",message:"已取消"+a})})}else"detail"===n?this.$router.push({name:"gameDetail",params:{gameId:t.id}}):"moveTopTask"===n?o.a.task.sort(this.stageId,t.id,2).then(function(){e.getData()}):"moveButtomTask"===n&&o.a.task.sort(this.stageId,t.id,1).then(function(){e.getData()})},sizeChangeHandler:function(n){this.pageSize=n,this.pageIndex=1,this.getData()},pageChangeHandler:function(n){this.pageIndex=n,this.getData()},getTaskTopBtnInfo:function(n){return{btn:"primary",label:"上移"}},getTasButtomkBtnInfo:function(n){return{btn:"primary",label:"下移"}},ifTopDisabled:function(n){return!!n&&n.ifTopDisabled},ifButtomDisabled:function(n){return!!n&&n.ifButtomDisabled},getStatusBtnInfo:function(n){if(!n)return{btn:"danger",label:"禁用"};var t=1*n.status;return{btn:0===t?"primary":"danger",label:this.$store.getters.getStatusTxt(!t)}}}},c={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"control-group"},[e("el-form",[e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:n.createGame}},[e("i",{staticClass:"fs-13 el-icon-plus mr-5"}),n._v("添加任务\n        ")])],1)],1)],1),n._v(" "),e("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.tabLoading,expression:"tabLoading"}],attrs:{tableData:n.tableData,tableOptions:n.tableOptions,total:n.totalCount},on:{edit:n.editHandler,delete:n.deleteHandler,action:n.actionHandler,"size-change":n.sizeChangeHandler,"page-change":n.pageChangeHandler},model:{value:n.pageIndex,callback:function(t){n.pageIndex=t},expression:"pageIndex"}})],1)},staticRenderFns:[]};var p=e("VU/8")(u,c,!1,function(n){e("4Nt9")},"data-v-0b344010",null);t.default=p.exports}});