webpackJsonp([36],{VLUk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("woOf"),i=r.n(a),p=r("Dd8w"),l=r.n(p),n=r("//Fk"),m=r.n(n),o=r("h9qX"),s=r("QbVN"),c=r("NYxO"),u={name:"editor",components:{uploadPrizeAvatar:s.a},data:function(){return{pageLoading:!0,action:this.$route.params.id?"modify":"add",prizeFrm:{id:this.$route.params.id||0,prize_type:1,prize_template_id:"",name:"",avatar:"",info:"",price:0,total:0,deliver_type:1,status:1,merchant_name:"",activity_name:"",bless:"",comment:""},frmRules:{name:[{required:!0,message:"名称必填"}],avatar:[{required:!0,message:"奖品封面必填"}],price:[{required:!0,message:"奖品价值必填"}],total:[{required:!0,message:"库存数量必填"}]},templateSelects:{}}},created:function(){var e=this;m.a.all([this.getDetail(),this.$store.dispatch("getTemplateSelect")]).then(function(t){if(e.templateSelects=t[1],!t[0]){var r=e.prizeTypeOptions[0].value;e.$set(e.prizeFrm,"prize_type",r),e.$set(e.prizeFrm,"prize_template_id",t[1]["template_"+r][0].value)}e.pageLoading=!1})},computed:l()({},Object(c.b)({prizeTypeOptions:"prizeTypeOptions"}),{prizeTemplateOptions:function(){return this.templateSelects["template_"+this.prizeFrm.prize_type]||[]}}),methods:{getDetail:function(){var e=this;return"modify"===this.action&&o.a.get(this.prizeFrm.id).then(function(t){return e.prizeFrm={id:t.id,prize_type:t.prize_type,prize_template_id:t.prize_template_id,name:t.name,avatar:t.avatar,info:t.info,price:t.price,total:t.total,deliver_type:t.deliver_type,status:t.status,merchant_name:t.merchant_name,activity_name:t.activity_name,bless:t.bless,comment:t.comment},t}).catch(function(t){return e.$alert("数据获取失败，返回奖品库存管理页面","错误",{confirmButtonText:"确定",callback:function(){e.$router.replace({name:"prizeTemplate"})}}),m.a.reject(t)})},save:function(){var e=this;this.$refs.prizeFrom.validate(function(t){t&&o.a.operation(e.prizeFrm).then(function(t){e.$router.back()})})},prizeTypeChange:function(){this.$set(this.prizeFrm,"prize_template_id","")},prizeTemplateChange:function(e){var t=this;o.b.get(e).then(function(e){1===t.prizeFrm.prize_type?t.prizeFrm=i()({},t.prizeFrm,{name:e.name,deliver_type:e.deliver_type,avatar:e.avatar,price:e.price,info:e.info,merchant_name:"",activity_name:"",bless:"",comment:""}):2===t.prizeFrm.prize_type?t.prizeFrm=i()({},t.prizeFrm,{name:e.name,deliver_type:"",avatar:e.avatar,price:e.price,info:e.info,merchant_name:e.merchant_name,activity_name:e.activity_name,bless:e.bless,comment:e.comment}):101===t.prizeFrm.prize_type&&(t.prizeFrm=i()({},t.prizeFrm,{name:e.name,deliver_type:"",avatar:"",price:"",info:"",merchant_name:"",activity_name:"",bless:"",comment:""}))})}}},z={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"prizeFrom",attrs:{model:e.prizeFrm,rules:e.frmRules,"label-width":"80px"}},[r("el-form-item",{attrs:{prop:"prize_type",label:"奖品类型"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.prizeTypeChange},model:{value:e.prizeFrm.prize_type,callback:function(t){e.$set(e.prizeFrm,"prize_type",t)},expression:"prizeFrm.prize_type"}},e._l(e.prizeTypeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{prop:"prize_template_id",label:"奖品模板"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.prizeTemplateChange},model:{value:e.prizeFrm.prize_template_id,callback:function(t){e.$set(e.prizeFrm,"prize_template_id",t)},expression:"prizeFrm.prize_template_id"}},e._l(e.prizeTemplateOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{prop:"total",label:"库存数量"}},[r("el-input-number",{attrs:{min:0,name:"total",placeholder:"库存数量"},model:{value:e.prizeFrm.total,callback:function(t){e.$set(e.prizeFrm,"total",t)},expression:"prizeFrm.total"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"name",label:"奖品名称"}},[r("el-input",{attrs:{placeholder:"请输入奖品名称",name:"name",clearable:!0},model:{value:e.prizeFrm.name,callback:function(t){e.$set(e.prizeFrm,"name",t)},expression:"prizeFrm.name"}})],1),e._v(" "),2===e.prizeFrm.prize_type?[r("el-form-item",{attrs:{prop:"merchant_name",label:"商户名称"}},[r("el-input",{attrs:{name:"merchant_name",placeholder:"红包商户名称显示"},model:{value:e.prizeFrm.merchant_name,callback:function(t){e.$set(e.prizeFrm,"merchant_name",t)},expression:"prizeFrm.merchant_name"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"activity_name",label:"活动名称"}},[r("el-input",{attrs:{name:"activity_name",placeholder:"例如可以填写促销活动的名称"},model:{value:e.prizeFrm.activity_name,callback:function(t){e.$set(e.prizeFrm,"activity_name",t)},expression:"prizeFrm.activity_name"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"bless",label:"红包祝福"}},[r("el-input",{attrs:{name:"bless",placeholder:"例如:新年快乐;谢谢惠顾"},model:{value:e.prizeFrm.bless,callback:function(t){e.$set(e.prizeFrm,"bless",t)},expression:"prizeFrm.bless"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"comment",label:"注释"}},[r("el-input",{attrs:{name:"comment",placeholder:"例如:10000个红包"},model:{value:e.prizeFrm.comment,callback:function(t){e.$set(e.prizeFrm,"comment",t)},expression:"prizeFrm.comment"}})],1)]:e._e(),e._v(" "),101!==e.prizeFrm.prize_type?[r("el-form-item",{attrs:{prop:"avatar",label:"奖品封面"}},[r("upload-prize-avatar",{model:{value:e.prizeFrm.avatar,callback:function(t){e.$set(e.prizeFrm,"avatar",t)},expression:"prizeFrm.avatar"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"info",label:"奖品介绍"}},[r("el-input",{attrs:{type:"textarea",rows:2,name:"info",placeholder:"请输入奖品介绍"},model:{value:e.prizeFrm.info,callback:function(t){e.$set(e.prizeFrm,"info",t)},expression:"prizeFrm.info"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"price",label:"奖品价值"}},[r("el-input",{attrs:{min:0,name:"price",placeholder:"奖品价值"},model:{value:e.prizeFrm.price,callback:function(t){e.$set(e.prizeFrm,"price",t)},expression:"prizeFrm.price"}},[r("label",{staticClass:"text-999",attrs:{slot:"append"},slot:"append"},[e._v("（元）")])])],1)]:e._e(),e._v(" "),1===e.prizeFrm.prize_type?[r("el-form-item",{attrs:{prop:"deliver_type",label:"兑奖方式"}},[r("el-radio",{attrs:{label:1},model:{value:e.prizeFrm.deliver_type,callback:function(t){e.$set(e.prizeFrm,"deliver_type",t)},expression:"prizeFrm.deliver_type"}},[e._v("快递物流\n        ")]),e._v(" "),r("el-radio",{attrs:{label:2},model:{value:e.prizeFrm.deliver_type,callback:function(t){e.$set(e.prizeFrm,"deliver_type",t)},expression:"prizeFrm.deliver_type"}},[e._v("线下兑奖\n        ")])],1)]:e._e(),e._v(" "),101!==e.prizeFrm.prize_type?[r("el-form-item",{attrs:{prop:"status",label:"启用奖品"}},[r("el-radio",{attrs:{label:0},model:{value:e.prizeFrm.status,callback:function(t){e.$set(e.prizeFrm,"status",t)},expression:"prizeFrm.status"}},[e._v("停用\n        ")]),e._v(" "),r("el-radio",{attrs:{label:1},model:{value:e.prizeFrm.status,callback:function(t){e.$set(e.prizeFrm,"status",t)},expression:"prizeFrm.status"}},[e._v("启用\n        ")])],1)]:e._e(),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.save(t)}}},[e._v("保存")]),e._v(" "),r("el-button",{on:{click:function(t){e.$router.back()}}},[e._v("取消")])],1)],2)],1)},staticRenderFns:[]},_=r("VU/8")(u,z,!1,null,null,null);t.default=_.exports}});