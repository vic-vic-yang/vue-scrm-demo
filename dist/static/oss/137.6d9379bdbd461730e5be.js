webpackJsonp([137],{"7xVT":function(n,e,t){var a=t("VMai");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("a765bc5a",a,!0)},LzfB:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("Dd8w"),i=t.n(a),s=t("YK4W"),r=t("9CDT"),o=t("0xDb"),l=t("M4fF"),d=t.n(l),u={name:"commodityList",components:{customElTable:s.a},data:function(){return{tableOptions:[{prop:"SELECTION"},{label:"编号",prop:"id",width:80},{label:"商品",prop:"goods",width:500,options:{type:"html"}},{label:"价格",prop:"price"},{label:"用户",prop:"user",options:{type:"html"}},{label:"下单日期",prop:"create_time",sortable:!0,width:160,className:"ph-6"},{label:"有效期",prop:"validate_time",sortable:!0,width:160,className:"ph-6"},{label:"状态",prop:"status_name"},{prop:"USER_ACTION",width:150,actions:[{type:"refund",options:this.getStatusBtnInfo}]}],ids:"",tableData:[],pageIndex:1,pageSize:20,totalCount:0,tabLoading:!0,refundQueryFrm:{goods_name:"",time:[],status:3},query:null,statusOptions:[{label:"全部",value:0},{label:"已完成",value:3},{label:"待退款",value:6},{label:"发起退款",value:7},{label:"退款中",value:8},{label:"退款完成",value:9}],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-6048e5),n.$emit("pick",[t,e])}},{text:"最近一个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-2592e6),n.$emit("pick",[t,e])}},{text:"最近三个月",onClick:function(n){var e=new Date,t=new Date;t.setTime(t.getTime()-7776e6),n.$emit("pick",[t,e])}}]}}},created:function(){this.query=d.a.cloneDeep(this.refundQueryFrm),this.getData()},computed:{refund_show:function(){var n=this.ids.split(",");return""!==this.ids&&n.length>0}},methods:{getData:function(){var n=this,e=this.query||{};this.tabLoading=!0,r.a.refund_list(i()({page_index:this.pageIndex,page_size:this.pageSize},e)).then(function(e){n.tableData=(e.result||[]).map(function(n){return i()({},n,{status_name:n.status_info.status_name,price:n.goods_info.price,create_time:1*n.create_time!=0?Object(o.c)(n.create_time):"--",validate_time:1*n.card_detail.validate_time>0?Object(o.c)(n.card_detail.validate_time):n.card_detail.validate_time||"--",goods:'<div style="display: flex;align-items: center;justify-content: space-between">\n                <div style="width: 180px; margin-left: 30px;"><img style="max-width: 200px;height: auto" src="'+n.goods_info.pic[0].file_path+'" alt=""/></div>\n                <div style="margin: 0 15px 0 30px;text-align: left">\n                  <div>订单号: <span style="display: inline-block;margin-left: 30px;">'+n.card_info.card_number+"</span></div>\n                  <div>"+n.goods_info.name+"</div>\n                </div>\n                </div>",user:"<div>"+n.user_name+"</div>\n                  <div>"+n.phone+"</div>"})}),n.totalCount=1*e.totalCount,n.tabLoading=!1})},searchOrderList:function(){this.query=d.a.cloneDeep(this.refundQueryFrm);var n=this.query.time;this.$set(this.query,"order_start_time",n[0]||""),this.$set(this.query,"order_end_time",n[1]||""),this.$delete(this.query,"time"),this.pageIndex=1,this.getData()},actionHandler:function(n,e){var t=this;if("refund"===n){this.ids=""+e.id,this.$confirm("确认立即退款此订单吗？","退款",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.refund({ids:t.ids}).then(function(){t.getData()}).catch(function(){t.$message({type:"info",message:"退款失败"})})}).catch(function(){t.$message({type:"info",message:"已取消退款"})})}},sizeChangeHandler:function(n){this.pageSize=n,this.pageIndex=1,this.getData()},pageChangeHandler:function(n){this.pageIndex=n,this.getData()},handleSelectionChange:function(n){this.ids=n.map(function(n){return n.id}).join(",")},handleRefund:function(){var n=this;this.$confirm("确认立即退款选择的订单吗？",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.refund({ids:n.ids}).then(function(){n.getData()})}).catch(function(){n.$message({type:"info",message:"已取消退款"})})},getStatusBtnInfo:function(n){return n?3===1*n.status_info.status&&{btn:"primary",label:"退款"}:{btn:"primary",label:"退款"}}}},c={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:n.tabLoading,expression:"tabLoading"}],staticClass:"app-container"},[t("div",{staticClass:"control-group"},[t("el-form",{attrs:{inline:!0,model:n.refundQueryFrm}},[t("el-form-item",{attrs:{label:"商品名"}},[t("el-input",{attrs:{placeholder:"商品名"},model:{value:n.refundQueryFrm.goods_name,callback:function(e){n.$set(n.refundQueryFrm,"goods_name",e)},expression:"refundQueryFrm.goods_name"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"创建时间"}},[t("el-date-picker",{attrs:{editable:!1,type:"datetimerange","picker-options":n.pickerOptions,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss",align:"right"},model:{value:n.refundQueryFrm.time,callback:function(e){n.$set(n.refundQueryFrm,"time",e)},expression:"refundQueryFrm.time"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"退款状态"}},[t("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:n.refundQueryFrm.status,callback:function(e){n.$set(n.refundQueryFrm,"status",e)},expression:"refundQueryFrm.status"}},n._l(n.statusOptions,function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}))],1),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:n.searchOrderList}},[n._v("查询")])],1)],1)],1),n._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:n.refund_show,expression:"refund_show"}],staticStyle:{padding:"15px 0"}},[t("el-button",{attrs:{type:"primary"},on:{click:n.handleRefund}},[n._v("退款")])],1),n._v(" "),t("custom-el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.tabLoading,expression:"tabLoading"}],attrs:{tableData:n.tableData,tableOptions:n.tableOptions,total:n.totalCount},on:{action:n.actionHandler,"size-change":n.sizeChangeHandler,handleSelectionChange:n.handleSelectionChange,"page-change":n.pageChangeHandler},model:{value:n.pageIndex,callback:function(e){n.pageIndex=e},expression:"pageIndex"}})],1)},staticRenderFns:[]};var p=t("VU/8")(u,c,!1,function(n){t("7xVT")},"data-v-0574ad72",null);e.default=p.exports},VMai:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});